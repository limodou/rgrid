function _simple_select2(e,t){var o=$(e),n=o.attr("data-url")||o.attr("url"),i=o.attr("placeholder")||"请选择";"string"==typeof t&&(n=t,t={});var r;r=n?{minimumInputLength:2,width:"100%",placeholder:i,allowClear:!0,language:"zh-CN",ajax:{url:n,data:function(e){return{term:e.term,label:"text",page:e.page}},dataType:"json",processResults:function(e,t){return t.page=t.page||1,{results:e,pagination:{more:20*t.page<e.length}}}}}:{width:"100%",allowClear:!0,placeholder:i,language:"zh-CN"},$(e).select2($.extend(!0,{},r,t))}var string_editor=function(e,t,o){var n=this,i=$(e),r=i.width(),a=i.height(),l=$(riot.util.tmpl('<input type="text" name={name} value="{value}" placeholder="{placeholder}" class="inline-editor"></input>',o));return l.css({position:"absolute",left:i.css("paddingLeft"),top:0,width:r,height:a,margin:0,padding:0,border:"none",boxSizing:"border-box",zIndex:1e3,fontSize:14,backgroundColor:"#ffefd5"}),i.append(l),l.focus().select(),l.on("keyup",function(e){if(13==e.keyCode){var i=l.val();t[o.name]=i,$.when(n.onEdited(t,o,i)).then(function(e){e&&(n.root.update(t),l.destroy())})}else 27==e.keyCode&&l.destroy()}),l.on("blur",function(e){l.destroy()}),l.destroy=function(){l.remove(),n.editor=null},l},select_editor=function(e,t,o){var n,i=this,r=$(e),a=r.width(),l=r.height(),d=[riot.util.tmpl('<select name={name} class="inline-editor">',{name:o.name})],u=o.editor.choices;o.editor.placeholder&&d.push('<option value="">'+o.editor.placeholder+"</option>");for(var s=0,p=u.length;s<p;s++)n={value:o.value,option_value:u[s][0],option_text:u[s][1]},d.push(riot.util.tmpl('<option {value==option_value?"selected":""} value={option_value}>{option_text}</option>',n));d.push("</select>");var c=$(d.join(""));return c.css({position:"absolute",left:0,top:0,width:a,height:l,margin:0,padding:0,border:"none",boxSizing:"border-box",zIndex:1e3,fontSize:14,backgroundColor:"#ffefd5"}),r.append(c),c.focus(),c.on("change",function(e){var n=c.val();t[o.name]=n,$.when(i.onEdited(t,o,n)).then(function(e){e&&(i.root.update(t),c.destroy())})}),c.destroy=function(){c.remove(),i.editor=null},c},date_editor=function(e,t,o){var n=this,i=$(e),r=i.width(),a=i.height(),l=$(riot.util.tmpl('<input type="text" name={name} value="{value}" placeholder="{placeholder}" class="inline-editor"></input>',o));return l.css({position:"absolute",left:0,top:0,width:r,height:a,margin:0,padding:0,border:"none",boxSizing:"border-box",zIndex:1e3,fontSize:14,backgroundColor:"#ffefd5"}),i.append(l),l.focus().select().pikaday({format:"YYYY-MM-DD",showTime:!1,onClose:function(){var e=l.val();t[o.name]=e,$.when(n.onEdited(t,o,e)).then(function(e){e&&(n.root.update(t),l.destroy())})}}),l.pikaday("show"),l.destroy=function(){l.remove(),n.editor=null},l},select2_editor=function(e,t,o){var n,i,r=this,a=$(e),l=a.width(),d=a.height(),u=[riot.util.tmpl('<select name={name} class="inline-editor">',{name:o.name})];i=o.editor.value_from?o.row[o.editor.value_from]:o.value;for(var s=o.editor.choices?o.editor.choices:[[i,o.value]],p=0,c=s.length;p<c;p++)n={value:i,option_value:s[p][0],option_text:s[p][1]},u.push(riot.util.tmpl('<option {value==option_value?"selected":""} value={option_value}>{option_text}</option>',n));u.push("</select>");var h=$(u.join(""));return h.css({position:"absolute",left:0,top:0,width:l,height:d,margin:0,padding:0,border:"none",boxSizing:"border-box",zIndex:1e3,fontSize:14,backgroundColor:"#ffefd5"}),a.append(h),h.focus(),o.editor.url&&h.attr("url",o.editor.url),o.editor.placeholder&&h.attr("placeholder",o.editor.placeholder),_simple_select2(h),a.find(".select2-container").css({zIndex:2e3,position:"absolute",left:0,top:0}),a.css({overflow:"visible",position:"relative"}),h.on("select2:close",function(e){h.destroy()}),h.on("change",function(e){var n=h.val();t[o.name]=n,o.editor.value_from?(t[o.editor.value_from]=n,t[o.name]=h.select2("data")[0].text):t[o.name]=n,$.when(r.onEdited(t,o,n)).then(function(e){e&&(r.root.update(t),h.destroy())})}),h.destroy=function(){h.data("select2")&&h.select2("destroy"),h.remove(),r.editor=null},h};